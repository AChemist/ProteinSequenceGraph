{
    "collab_server" : "",
    "contents" : "\n# Load Libs ---------------------------------------------------------------\n\nlibrary(ggplot2)\nlibrary(plyr)\nlibrary(UniProt.ws)\n\n\n# Functions ---------------------------------------------------------------\n\n# sequence2Matrix <- function( sequence ){\n#   \n#   dim <- ceiling(sqrt(nchar(sequence)))\n#   diff <- dim * dim - nchar(sequence)\n#   sequence <- paste0(sequence, paste0(rep(\"-\", diff), collapse = \"\"), collapse = \"\")\n#   sequenceVector <- unlist(strsplit(sequence, split = \"\"))\n#   sequenceMatrix <- matrix( sequenceVector, ncol = dim,  nrow = dim, byrow = TRUE)\n#   \n#   # dim <- ceiling(nchar(sequence)/30)\n#   # diff <- dim * 30 - nchar(sequence)\n#   # sequence <- paste0(sequence, paste0(rep(\"-\", diff), collapse = \"\"), collapse = \"\")\n#   # sequenceVector <- unlist(strsplit(sequence, split = \"\"))\n#   # sequenceMatrix <- matrix( sequenceVector, ncol = 30,  nrow = dim, byrow = TRUE) \n#   return(sequenceMatrix)\n# }\n\nsequence2Dataframe <- function( sequence ){\n  \n  dim <- ceiling(sqrt(nchar(sequence)))\n  diff <- dim * dim - nchar(sequence)\n  sequence <- paste0(sequence, paste0(rep(\"-\", diff), collapse = \"\"), collapse = \"\")\n  sequenceVector <- unlist(strsplit(sequence, split = \"\"))\n  x <- rep(1:dim, dim)\n  y <- sort(rep(1:dim, dim)) \n  \n  \n  # dim <- ceiling(nchar(sequence)/30)\n  # diff <- dim * 30 - nchar(sequence)\n  # sequence <- paste0(sequence, paste0(rep(\"-\", diff), collapse = \"\"), collapse = \"\")\n  # sequenceVector <- unlist(strsplit(sequence, split = \"\"))\n  # sequenceMatrix <- matrix( sequenceVector, ncol = 30,  nrow = dim, byrow = TRUE) \n  return( data.frame( row = y, col = x, AA = sequenceVector, position = 1:(dim*dim) ) )\n}\n\nfetchSequence <- function( accession = \"P02671\" ){\n  \n  up <- UniProt.ws(taxId=9606)\n  \n  #keytypes(up)\n  \n  sequence <- select(up, accession, \"SEQUENCE\", \"UNIPROTKB\" )[1,2]\n\n  return(sequence)  \n}\n\n# fetchSequence <- function( accession = \"P02671\" ){\n#   \n#   up <- UniProt.ws(taxId=9606)\n#   \n#   #keytypes(up)\n#   \n#   test <- select(up, accession, \"PHOSSITE\", \"UNIPROTKB\" )\n#   \n#   return(sequence)  \n# }\n\n\n# Example -----------------------------------------------------------------\n\naccession <- \"P02671\"\n\nsequence <- fetchSequence(accession) \n\n#d <- sequence2Matrix(d)\n\nsequenceDframe <- sequence2Dataframe(sequence)\n\np <- ggplot()\np <- p + ggtitle(accession)\np <- p + scale_y_continuous(trans = \"reverse\")\n\ncleavageSites <- sequenceDframe[ sequenceDframe$position %in% gregexpr(pattern = \"[RK][^P]\", sequence )[[1]],]\np <- p + geom_tile(data =  cleavageSites,  aes(col, row), inherit.aes = FALSE, fill = \"green\")\np\n\np <- p + geom_text( data = sequenceDframe, aes(col, row, label = AA)) \np\n\n\n# psites <- c(37,88,3,678)\n# psiteDframe <- sequenceDframe[ sequenceDframe$position %in% psites  ,]\n# \n# p <- p + geom_text(data =  psiteDframe,  aes(col, row, label = AA), inherit.aes = FALSE, colour = \"red\")\n\npeptides <- data.frame(peptideSequence = c(\"GLIDEVNQDFTNR\",\"Test2\"), start = c(72,360), stop = c(84, 375))\npeptides <- ddply(peptides, .(peptideSequence), transform, positions = start:stop )\npeptidesDframe <- sequenceDframe[ sequenceDframe$position %in% peptides$positions  ,]\n \np <- p + geom_text(data =  peptidesDframe,  aes(col, row, label = AA), inherit.aes = FALSE, colour = \"green\")\np <- p + geom_text(data =  cleavageSites,  aes(col, row, label = AA), inherit.aes = FALSE, colour = \"black\")\np\n\n\ncleavageSites <- sequenceDframe[ sequenceDframe$position %in% gregexpr(pattern = \"[RK][^P]\", sequence )[[1]],]\np <- p + geom_text(data =  cleavageSites,  aes(col, row, label = AA), inherit.aes = FALSE, colour = \"red\")\np\n\n\n\nregmatches(sequence,gregexpr(pattern = \"[N][G]\", sequence ))\nregmatches(sequence,gregexpr(pattern = \"[RK][EQ]\", sequence ))\n\n\n\n",
    "created" : 1518816348114.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1736918118",
    "id" : "6924631A",
    "lastKnownWriteTime" : 1518897202,
    "last_content_update" : 1518897202813,
    "path" : "~/GitHub/ProteinSequenceGraph/ProteinSequenceGraph.R",
    "project_path" : "ProteinSequenceGraph.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}